using OpenQA.Selenium;

using OpenQA.Selenium.Support.UI;

using System;

using System.Linq;
 
namespace TheConnectedShop.Pages

{

    public class SearchResultsPage

    {

        private readonly IWebDriver _driver;

        private readonly WebDriverWait _wait;
 
        public SearchResultsPage(IWebDriver driver, WebDriverWait wait)

        {

            _driver = driver;

            _wait = wait;

        }
 
        private By ResultItems => By.CssSelector(".search-results__item");
 
        /// <summary>

        /// Возвращает первый найденный результат из поиска.

        /// </summary>

        public IWebElement FirstResult()

        {

            var results = _wait.Until(d =>

            {

                var items = d.FindElements(ResultItems);

                return items.Count > 0 ? items : null;

            });
 
            return results.First();

        }
 
        /// <summary>

        /// Клик по первому найденному результату.

        /// </summary>

        public void ClickFirstResult() => FirstResult().Click();
 
        /// <summary>

        /// Возвращает количество найденных элементов.

        /// </summary>

        public int GetResultsCount() => _driver.FindElements(ResultItems).Count;

    }

}

 